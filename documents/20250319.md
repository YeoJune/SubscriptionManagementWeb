# 배송 관리 시스템 서비스 흐름

이 문서는 배송 관리 시스템의 전체적인 서비스 흐름과 각 사용자 역할에 따른 주요 기능을 설명합니다.

## 1. 시스템 개요

본 시스템은 정기 배송 서비스를 관리하기 위한 플랫폼으로, 사용자가 상품을 구독하면 지정된 요일(월, 수, 금)에 배송이 이루어지는 서비스입니다. 시스템은 크게 사용자, 매장, 관리자 세 가지 관점으로 구성되어 있습니다.

## 2. 주요 사용자 역할

### 일반 사용자

- 서비스 구독자로, 상품을 선택하고 결제하여 정기 배송을 받는 대상

### 매장 담당자

- 당일 배송을 처리하고 배송 상태를 관리하는 담당자

### 관리자

- 전체 시스템을 관리하고 사용자, 상품, 공지사항, 배송 등 모든 요소를 관리하는 담당자

## 3. 핵심 비즈니스 프로세스

### 3.1 사용자 등록 및 로그인 과정

1. 사용자가 회원가입 페이지에서 아이디, 비밀번호, 전화번호 입력
2. 시스템이 사용자 정보 검증 후 계정 생성
3. 생성된 계정으로 로그인하여 서비스 이용 시작

### 3.2 상품 구독 및 결제 과정

1. 사용자가 로그인 후 상품 목록에서 원하는 상품 선택
2. 원하는 배송 횟수 선택 (예: 10회, 20회 등)
3. 결제 진행 (임시 결제 처리)
4. 결제 완료 시, 시스템은 자동으로:
   - 사용자 계정의 배송 잔여 횟수 업데이트
   - 월수금(월요일, 수요일, 금요일)을 기준으로 배송 일정 자동 생성
   - 향후 배송 스케줄을 사용자에게 표시

### 3.3 배송 처리 과정

1. 매장 담당자가 당일 배송 목록 확인
2. 각 배송건에 대해 처리:
   - 배송 준비 및 발송
   - 배송 상태를 '완료(complete)'로 변경
3. 상태 변경 시 시스템은 자동으로:
   - 사용자에게 배송 완료 SMS 발송
   - 배송 기록 업데이트

### 3.4 배송 취소 처리 과정

1. 매장 담당자 또는 관리자가 배송 취소 결정
2. 배송 상태를 '취소(cancel)'로 변경
3. 시스템은 자동으로:
   - 사용자의 배송 잔여 횟수 1회 증가 (환불 처리)
   - 배송 기록 업데이트

### 3.5 배송 잔여 횟수 관리 과정

1. 시스템이 주기적으로 사용자의 배송 잔여 횟수 확인
2. 잔여 횟수에 따라 알림 발송:
   - 잔여 횟수가 3회 이하인 경우: 독촉 SMS 발송
   - 잔여 횟수가 0회인 경우: 소진 알림 SMS 발송
3. 사용자는 추가 결제를 통해 배송 횟수 충전 가능

## 4. 주요 화면 및 기능 흐름

### 4.1 사용자 페이지 흐름

#### 4.1.1 시작 화면

- 로그인/회원가입 링크
- 서비스 소개 내용
- 공지사항 링크

#### 4.1.2 로그인 후 화면

- 개인 구독 현황 (상품, 남은 배송 횟수, 다음 배송 일정)
- 배송 내역 목록 (과거, 예정된 배송)
- 추가 구독/결제 옵션
- 공지사항 및 FAQ 확인
- 고객의 소리 링크

#### 4.1.3 결제 프로세스

1. 상품 선택
2. 배송 횟수 선택
3. 결제 정보 입력
4. 결제 확인 및 완료

### 4.2 매장용 페이지 흐름

#### 4.2.1 시작 화면

- 로그인 (관리자 권한 필요)
- 당일 배송 목록 중심의 대시보드

#### 4.2.2 배송 관리

- 당일 배송 목록 조회 (정렬, 필터링, 페이지네이션 지원)
- 배송 상태 관리 (대기중, 완료, 취소 상태 변경)
- 배송 상세 정보 확인 (사용자, 상품, 연락처 등)

#### 4.2.3 사용자 관리

- 사용자 검색 및 조회
- 사용자 정보 확인 및 편집
- 사용자 추가/삭제

#### 4.2.4 알림 발송

- 배송 완료 시 자동 발송되는 알림
- 독촉 문자 수동/자동 발송

### 4.3 관리자 페이지 흐름

#### 4.3.1 시작 화면

- 로그인 (관리자 권한 필요)
- 전체 시스템 현황 대시보드 (사용자 수, 당일 배송 수, 취소 건수 등)

#### 4.3.2 배송 관리

- 전체 배송 목록 조회 (날짜, 상태 등 다양한 필터링)
- 배송 상태 관리
- 배송 통계 확인

#### 4.3.3 사용자 관리

- 사용자 목록 조회
- 사용자 상세 정보 관리
- 사용자 권한 설정

#### 4.3.4 상품 관리

- 상품 목록 조회
- 상품 추가/수정/삭제
- 가격 정책 관리

#### 4.3.5 공지사항 관리

- 일반 공지사항 작성/수정/삭제
- FAQ 작성/수정/삭제

## 5. 주요 기술적 흐름

### 5.1 인증 및 권한 관리 흐름

- 세션 기반 인증을 통한 사용자 식별
- 역할별 권한 관리 (일반 사용자, 매장 담당자, 관리자)
- 인증 필요 API에 대한 미들웨어 보호

### 5.2 배송 스케줄링 처리 흐름

- 결제 후 배송 날짜 자동 계산 (월수금 배송일 기준)
- 사용자별 배송 일정 관리
- 당일 배송 자동 필터링

### 5.3 알림 처리 흐름

- 배송 상태 변경 시 자동 알림 발송
- 잔여 횟수 부족 시 알림 발송
- SMS 발송 로그 기록

## 6. 데이터 흐름

### 6.1 사용자 데이터

- 기본 정보 (ID, 비밀번호, 전화번호)
- 구독 상태 (배송 잔여 횟수)

### 6.2 상품 데이터

- 상품 정보 (이름, 설명, 가격)

### 6.3 배송 데이터

- 배송 정보 (사용자, 상품, 날짜, 상태)
- 배송 상태 변경 이력

### 6.4 결제 데이터

- 결제 정보 (사용자, 상품, 금액, 구매 횟수)

## 7. 사용자 경험 시나리오

### 7.1 신규 사용자 시나리오

1. 사용자가 서비스 웹사이트 방문
2. 회원가입 후 로그인
3. 상품 브라우징 및 선택
4. 배송 횟수 선택 및 결제
5. 배송 일정 확인 (월, 수, 금 배송)
6. 첫 배송일에 상품 수령
7. 배송 완료 SMS 확인

### 7.2 기존 사용자 시나리오

1. 로그인하여 배송 잔여 횟수 확인
2. 배송 일정 확인 (남은 배송 일정)
3. 필요시 추가 결제하여 배송 횟수 충전
4. 배송 내역 확인 및 관리

### 7.3 배송 횟수 소진 시나리오

1. 시스템이 배송 잔여 횟수 3회 이하 감지
2. 사용자에게 독촉 SMS 발송
3. 배송 횟수 완전 소진 시 만료 SMS 발송
4. 사용자가 로그인하여 추가 결제 진행
5. 배송 일정 자동 연장

## 8. 확장 가능성 및 향후 개발 방향

### 8.1 기능 확장 방향

- 배송 일정 사용자 커스터마이징 (요일 선택 가능)
- 실시간 배송 추적 기능
- 정기 구독 할인 시스템
- 사용자 리뷰 시스템

### 8.2 기술적 확장 방향

- 실제 결제 시스템 연동
- 실제 SMS 서비스 연동
- 모바일 앱 개발
- 배송 자동화 시스템 연계

## 9. 시스템 통합 포인트

### 9.1 외부 시스템 연동

- 결제 시스템 연동 포인트
- SMS 서비스 연동 포인트
- 배송 추적 시스템 연동 포인트

### 9.2 내부 시스템 연동

- 프론트엔드와 백엔드 API 연동
- 데이터베이스 액세스 포인트
- 배치 프로세스 연동 (일일 배송 목록 생성, 알림 발송 등)

## 10. 요약 및 중요 포인트

1. **핵심 가치**: 정기 배송 서비스의 효율적인 관리
2. **주요 요일**: 월, 수, 금 배송 운영
3. **주요 상태**: 배송 상태(대기중, 완료, 취소)에 따른 처리
4. **알림 시스템**: 배송 완료 및 잔여 횟수 알림을 통한 사용자 경험 향상
5. **다중 역할**: 사용자, 매장, 관리자별 맞춤형 기능 제공
